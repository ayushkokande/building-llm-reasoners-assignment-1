============================= test session starts ==============================
platform darwin -- Python 3.12.12, pytest-8.4.1, pluggy-1.6.0 -- /Users/kokande/Desktop/Semester 2/Building LLM Reasoners/nyu-llm-reasoners-a1/.venv/bin/python
cachedir: .pytest_cache
metadata: {'Python': '3.12.12', 'Platform': 'macOS-26.2-arm64-arm-64bit', 'Packages': {'pytest': '8.4.1', 'pluggy': '1.6.0'}, 'Plugins': {'json-report': '1.5.0', 'metadata': '3.1.1', 'jaxtyping': '0.3.2'}, 'CI': '1'}
rootdir: /Users/kokande/Desktop/Semester 2/Building LLM Reasoners/nyu-llm-reasoners-a1
configfile: pyproject.toml
plugins: json-report-1.5.0, metadata-3.1.1, jaxtyping-0.3.2
collecting ... collected 1 item

tests/test_train_bpe.py::test_train_bpe_special_tokens FAILED

=================================== FAILURES ===================================
________________________ test_train_bpe_special_tokens _________________________

snapshot = <tests.conftest.Snapshot object at 0x1296c65d0>

    def test_train_bpe_special_tokens(snapshot):
        """
        Ensure that the special tokens are added to the vocabulary and not
        merged with other tokens.
        """
        input_path = FIXTURES_PATH / "tinystories_sample_5M.txt"
        vocab, merges = run_train_bpe(
            input_path=input_path,
            vocab_size=1000,
            special_tokens=["<|endoftext|>"],
        )
    
        # Check that the special token is not in the vocab
        vocabs_without_specials = [word for word in vocab.values() if word != b"<|endoftext|>"]
        for word_bytes in vocabs_without_specials:
            assert b"<|" not in word_bytes
    
>       snapshot.assert_match(
            {
                "vocab_keys": set(vocab.keys()),
                "vocab_values": set(vocab.values()),
                "merges": merges,
            },
        )

tests/test_train_bpe.py:82: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <tests.conftest.Snapshot object at 0x1296c65d0>
actual = {'merges': [(b'h', b'e'), (b' ', b't'), (b' ', b'a'), (b' ', b's'), (b' ', b'w'), (b'n', b'd'), ...], 'vocab_keys': {0, 1, 2, 3, 4, 5, ...}, 'vocab_values': {b'\x00', b'\x01', b'\x02', b'\x03', b'\x04', b'\x05', ...}}
test_name = 'test_train_bpe_special_tokens', force_update = False

    def assert_match(
        self,
        actual: _A | dict[str, _A],
        test_name: str | type[DEFAULT] = DEFAULT,
        force_update: bool | type[DEFAULT] = DEFAULT,
    ):
        """
        Assert that the actual data matches the snapshot.
        Args:
            actual: Single object or dictionary of named objects
            test_name: The name of the test (used for the snapshot file)
            force_update: If True, update the snapshot instead of comparing
        """
    
        if force_update is DEFAULT:
            force_update = self.default_force_update
        if test_name is DEFAULT:
            assert self.default_test_name is not None, "Test name must be provided or set as default"
            test_name = self.default_test_name
    
        snapshot_path = self._get_snapshot_path(test_name)
    
        # Load the snapshot
        with open(snapshot_path, "rb") as f:
            expected_data = pickle.load(f)
    
        if isinstance(actual, dict):
            for key in actual:
                if key not in expected_data:
                    raise AssertionError(f"Key '{key}' not found in snapshot for {test_name}")
>               assert actual[key] == expected_data[key], (
                    f"Data for key '{key}' does not match snapshot for {test_name}"
                )
E               AssertionError: Data for key 'vocab_values' does not match snapshot for test_train_bpe_special_tokens
E               assert {b'\x00', b'\... b'\x05', ...} == {b'\x00', b'\... b'\x05', ...}
E                 
E                 Extra items in the left set:
E                 b' magic'
E                 Extra items in the right set:
E                 b'\n\n\n'
E                 
E                 Full diff:
E                   {
E                       b'\x00',
E                       b'\x01',
E                       b'\x02',
E                       b'\x03',
E                       b'\x04',
E                       b'\x05',
E                       b'\x06',
E                       b'\x07',
E                       b'\x08',
E                       b'\t',
E                       b'\n',
E                       b'\n\n',
E                 -     b'\n\n\n',
E                       b'\x0b',
E                       b'\x0c',
E                       b'\r',
E                       b'\x0e',
E                       b'\x0f',
E                       b'\x10',
E                       b'\x11',
E                       b'\x12',
E                       b'\x13',
E                       b'\x14',
E                       b'\x15',
E                       b'\x16',
E                       b'\x17',
E                       b'\x18',
E                       b'\x19',
E                       b'\x1a',
E                       b'\x1b',
E                       b'\x1c',
E                       b'\x1d',
E                       b'\x1e',
E                       b'\x1f',
E                       b' ',
E                       b' "',
E                       b' A',
E                       b' Amy',
E                       b' And',
E                       b' Anna',
E                       b' B',
E                       b' Ben',
E                       b' Bob',
E                       b' But',
E                       b' D',
E                       b' E',
E                       b' Every',
E                       b' F',
E                       b' From',
E                       b' H',
E                       b' He',
E                       b' Her',
E                       b' His',
E                       b' I',
E                       b' In',
E                       b' It',
E                       b' J',
E                       b' K',
E                       b' Kitty',
E                       b' L',
E                       b' Lily',
E                       b' Lucy',
E                       b' M',
E                       b' Max',
E                       b' Mia',
E                       b' Mom',
E                       b' N',
E                       b' One',
E                       b' P',
E                       b' S',
E                       b' Sally',
E                       b' Sam',
E                       b' Sara',
E                       b' She',
E                       b' So',
E                       b' Spot',
E                       b' Sue',
E                       b' T',
E                       b' Th',
E                       b' The',
E                       b' Then',
E                       b' They',
E                       b' Tim',
E                       b' Tom',
E                       b' W',
E                       b' We',
E                       b' When',
E                       b' You',
E                       b' a',
E                       b' ab',
E                       b' about',
E                       b' after',
E                       b' ag',
E                       b' again',
E                       b' al',
E                       b' all',
E                       b' always',
E                       b' am',
E                       b' an',
E                       b' and',
E                       b' animal',
E                       b' animals',
E                       b' any',
E                       b' anymore',
E                       b' app',
E                       b' are',
E                       b' around',
E                       b' as',
E                       b' asked',
E                       b' at',
E                       b' away',
E                       b' b',
E                       b' back',
E                       b' bad',
E                       b' ball',
E                       b' be',
E                       b' bear',
E                       b' beaut',
E                       b' bec',
E                       b' became',
E                       b' because',
E                       b' best',
E                       b' better',
E                       b' big',
E                       b' bird',
E                       b' bl',
E                       b' blue',
E                       b' bo',
E                       b' boat',
E                       b' book',
E                       b' bot',
E                       b' both',
E                       b' box',
E                       b' boy',
E                       b' br',
E                       b' bro',
E                       b' bu',
E                       b' bug',
E                       b' but',
E                       b' by',
E                       b' c',
E                       b' ca',
E                       b' cake',
E                       b' call',
E                       b' came',
E                       b' can',
E                       b' car',
E                       b' care',
E                       b' careful',
E                       b' cat',
E                       b' ch',
E                       b' che',
E                       b' cl',
E                       b' cle',
E                       b' clean',
E                       b' clim',
E                       b' clo',
E                       b' co',
E                       b' col',
E                       b' color',
E                       b' com',
E                       b' come',
E                       b' could',
E                       b' cu',
E                       b' d',
E                       b' dad',
E                       b' dan',
E                       b' day',
E                       b' dec',
E                       b' decided',
E                       b' did',
E                       b' didn',
E                       b' do',
E                       b' dog',
E                       b' doll',
E                       b' don',
E                       b' door',
E                       b' down',
E                       b' dre',
E                       b' e',
E                       b' each',
E                       b' eat',
E                       b' en',
E                       b' end',
E                       b' even',
E                       b' ever',
E                       b' every',
E                       b' ex',
E                       b' exc',
E                       b' excited',
E                       b' f',
E                       b' fa',
E                       b' fam',
E                       b' family',
E                       b' far',
E                       b' fast',
E                       b' fe',
E                       b' feel',
E                       b' felt',
E                       b' fi',
E                       b' find',
E                       b' fish',
E                       b' fl',
E                       b' flew',
E                       b' flow',
E                       b' fly',
E                       b' fo',
E                       b' food',
E                       b' for',
E                       b' fore',
E                       b' forest',
E                       b' found',
E                       b' fr',
E                       b' friend',
E                       b' friends',
E                       b' frog',
E                       b' from',
E                       b' fun',
E                       b' g',
E                       b' garden',
E                       b' gave',
E                       b' get',
E                       b' gir',
E                       b' girl',
E                       b' give',
E                       b' gl',
E                       b' go',
E                       b' good',
E                       b' got',
E                       b' gr',
E                       b' gra',
E                       b' gre',
E                       b' great',
E                       b' ground',
E                       b' h',
E                       b' ha',
E                       b' had',
E                       b' hand',
E                       b' happ',
E                       b' happened',
E                       b' happily',
E                       b' happy',
E                       b' hard',
E                       b' hat',
E                       b' have',
E                       b' he',
E                       b' heard',
E                       b' hel',
E                       b' help',
E                       b' helped',
E                       b' her',
E                       b' hig',
E                       b' high',
E                       b' him',
E                       b' his',
E                       b' ho',
E                       b' home',
E                       b' house',
E                       b' how',
E                       b' hug',
E                       b' hugged',
E                       b' hurt',
E                       b' ide',
E                       b' idea',
E                       b' if',
E                       b' im',
E                       b' in',
E                       b' inside',
E                       b' int',
E                       b' into',
E                       b' is',
E                       b' it',
E                       b' its',
E                       b' j',
E                       b' jump',
E                       b' jumped',
E                       b' just',
E                       b' k',
E                       b' ke',
E                       b' kid',
E                       b' kind',
E                       b' kn',
E                       b' knew',
E                       b' know',
E                       b' l',
E                       b' la',
E                       b' laug',
E                       b' laughed',
E                       b' le',
E                       b' learn',
E                       b' learned',
E                       b' let',
E                       b' li',
E                       b' like',
E                       b' liked',
E                       b' list',
E                       b' listen',
E                       b' little',
E                       b' lived',
E                       b' lo',
E                       b' long',
E                       b' loo',
E                       b' look',
E                       b' looked',
E                       b' lot',
E                       b' lots',
E                       b' loud',
E                       b' love',
E                       b' loved',
E                       b' m',
E                       b' ma',
E                       b' made',
E                       b' mag',
E                 +     b' magic',
E                       b' make',
E                       b' man',
E                       b' many',
E                       b' me',
E                       b' met',
E                       b' mo',
E                       b' mom',
E                       b' more',
E                       b' much',
E                       b' my',
E                       b' n',
E                       b' nam',
E                       b' named',
E                       b' ne',
E                       b' near',
E                       b' need',
E                       b' never',
E                       b' new',
E                       b' next',
E                       b' nice',
E                       b' no',
E                       b' not',
E                       b' now',
E                       b' o',
E                       b' of',
E                       b' off',
E                       b' old',
E                       b' on',
E                       b' one',
E                       b' op',
E                       b' opened',
E                       b' or',
E                       b' other',
E                       b' out',
E                       b' outside',
E                       b' over',
E                       b' p',
E                       b' par',
E                       b' park',
E                       b' pe',
E                       b' people',
E                       b' pic',
E                       b' picked',
E                       b' pl',
E                       b' place',
E                       b' play',
E                       b' played',
E                       b' playing',
E                       b' po',
E                       b' pr',
E                       b' pret',
E                       b' pretty',
E                       b' proud',
E                       b' put',
E                       b' qu',
E                       b' r',
E                       b' ran',
E                       b' re',
E                       b' red',
E                       b' ro',
E                       b' rock',
E                       b' room',
E                       b' run',
E                       b' s',
E                       b' sa',
E                       b' sad',
E                       b' safe',
E                       b' said',
E                       b' saw',
E                       b' say',
E                       b' says',
E                       b' sc',
E                       b' scared',
E                       b' se',
E                       b' see',
E                       b' sh',
E                       b' share',
E                       b' she',
E                       b' shiny',
E                       b' should',
E                       b' show',
E                       b' showed',
E                       b' sk',
E                       b' sky',
E                       b' sl',
E                       b' sm',
E                       b' small',
E                       b' smile',
E                       b' smiled',
E                       b' sn',
E                       b' so',
E                       b' some',
E                       b' somet',
E                       b' something',
E                       b' sor',
E                       b' sorry',
E                       b' sp',
E                       b' special',
E                       b' squ',
E                       b' st',
E                       b' star',
E                       b' started',
E                       b' stick',
E                       b' still',
E                       b' sto',
E                       b' stor',
E                       b' str',
E                       b' strong',
E                       b' sun',
E                       b' sur',
E                       b' surpr',
E                       b' surprised',
E                       b' sw',
E                       b' t',
E                       b' ta',
E                       b' take',
E                       b' tal',
E                       b' te',
E                       b' th',
E                       b' than',
E                       b' thanked',
E                       b' that',
E                       b' the',
E                       b' their',
E                       b' them',
E                       b' then',
E                       b' there',
E                       b' they',
E                       b' things',
E                       b' this',
E                       b' thought',
E                       b' time',
E                       b' to',
E                       b' together',
E                       b' told',
E                       b' too',
E                       b' took',
E                       b' tow',
E                       b' town',
E                       b' toy',
E                       b' toys',
E                       b' tr',
E                       b' tre',
E                       b' tree',
E                       b' tried',
E                       b' try',
E                       b' turn',
E                       b' tw',
E                       b' u',
E                       b' un',
E                       b' under',
E                       b' unexpected',
E                       b' unt',
E                       b' until',
E                       b' up',
E                       b' upon',
E                       b' us',
E                       b' v',
E                       b' very',
E                       b' w',
E                       b' wa',
E                       b' wal',
E                       b' walk',
E                       b' walked',
E                       b' want',
E                       b' wanted',
E                       b' was',
E                       b' wat',
E                       b' water',
E                       b' way',
E                       b' we',
E                       b' went',
E                       b' were',
E                       b' wh',
E                       b' what',
E                       b' when',
E                       b' who',
E                       b' will',
E                       b' wind',
E                       b' with',
E                       b' wor',
E                       b' would',
E                       b' y',
E                       b' you',
E                       b' your',
E                       b'!',
E                       b'!"',
E                       b'"',
E                       b'#',
E                       b'$',
E                       b'%',
E                       b'&',
E                       b"'",
E                       b"'m",
E                       b"'s",
E                       b"'t",
E                       b'(',
E                       b')',
E                       b'*',
E                       b'+',
E                       b',',
E                       b',"',
E                       b'-',
E                       b'.',
E                       b'."',
E                       b'/',
E                       b'0',
E                       b'1',
E                       b'2',
E                       b'3',
E                       b'4',
E                       b'5',
E                       b'6',
E                       b'7',
E                       b'8',
E                       b'9',
E                       b':',
E                       b';',
E                       b'<',
E                       b'<|endoftext|>',
E                       b'=',
E                       b'>',
E                       b'?',
E                       b'?"',
E                       b'@',
E                       b'A',
E                       b'As',
E                       b'B',
E                       b'But',
E                       b'C',
E                       b'Can',
E                       b'D',
E                       b'E',
E                       b'F',
E                       b'G',
E                       b'H',
E                       b'I',
E                       b'J',
E                       b'K',
E                       b'L',
E                       b'Let',
E                       b'Lily',
E                       b'M',
E                       b'Mom',
E                       b'N',
E                       b'No',
E                       b'O',
E                       b'On',
E                       b'Once',
E                       b'One',
E                       b'P',
E                       b'Q',
E                       b'R',
E                       b'S',
E                       b'T',
E                       b'Th',
E                       b'Thank',
E                       b'The',
E                       b'They',
E                       b'Tim',
E                       b'Tom',
E                       b'U',
E                       b'V',
E                       b'W',
E                       b'Wh',
E                       b'X',
E                       b'Y',
E                       b'Yes',
E                       b'You',
E                       b'Z',
E                       b'[',
E                       b'\\',
E                       b']',
E                       b'^',
E                       b'_',
E                       b'`',
E                       b'a',
E                       b'ab',
E                       b'able',
E                       b'ace',
E                       b'ach',
E                       b'ack',
E                       b'ad',
E                       b'ade',
E                       b'ady',
E                       b'ag',
E                       b'age',
E                       b'ain',
E                       b'ak',
E                       b'ake',
E                       b'al',
E                       b'all',
E                       b'ally',
E                       b'am',
E                       b'ame',
E                       b'an',
E                       b'and',
E                       b'ank',
E                       b'ant',
E                       b'ap',
E                       b'ar',
E                       b'ara',
E                       b'ard',
E                       b'arden',
E                       b'are',
E                       b'ared',
E                       b'ark',
E                       b'arn',
E                       b'ary',
E                       b'as',
E                       b'ase',
E                       b'at',
E                       b'ate',
E                       b'ause',
E                       b'aut',
E                       b'ave',
E                       b'ax',
E                       b'ay',
E                       b'b',
E                       b'bed',
E                       b'ber',
E                       b'by',
E                       b'c',
E                       b'ce',
E                       b'ch',
E                       b'ched',
E                       b'ck',
E                       b'ct',
E                       b'd',
E                       b'dd',
E                       b'dy',
E                       b'e',
E                       b'ec',
E                       b'eci',
E                       b'ecial',
E                       b'ed',
E                       b'el',
E                       b'ell',
E                       b'elt',
E                       b'em',
E                       b'en',
E                       b'end',
E                       b'ened',
E                       b'ent',
E                       b'ep',
E                       b'er',
E                       b'ers',
E                       b'es',
E                       b'ess',
E                       b'et',
E                       b'etter',
E                       b'ew',
E                       b'ex',
E                       b'expected',
E                       b'f',
E                       b'fe',
E                       b'ff',
E                       b'ft',
E                       b'fter',
E                       b'ful',
E                       b'g',
E                       b'ge',
E                       b'ged',
E                       b'get',
E                       b'gether',
E                       b'gry',
E                       b'h',
E                       b'he',
E                       b'hed',
E                       b'hen',
E                       b'her',
E                       b'here',
E                       b'hes',
E                       b'hing',
E                       b'ht',
E                       b'i',
E                       b'ia',
E                       b'ic',
E                       b'ice',
E                       b'ick',
E                       b'id',
E                       b'ide',
E                       b'ided',
E                       b'ie',
E                       b'ies',
E                       b'if',
E                       b'ig',
E                       b'ight',
E                       b'il',
E                       b'ild',
E                       b'ile',
E                       b'iled',
E                       b'ill',
E                       b'ily',
E                       b'im',
E                       b'imal',
E                       b'ime',
E                       b'in',
E                       b'ind',
E                       b'ine',
E                       b'ing',
E                       b'ings',
E                       b'ink',
E                       b'iny',
E                       b'ion',
E                       b'ip',
E                       b'ir',
E                       b'ird',
E                       b'is',
E                       b'ise',
E                       b'ised',
E                       b'ish',
E                       b'ist',
E                       b'it',
E                       b'ite',
E                       b'ited',
E                       b'ith',
E                       b'itt',
E                       b'ittle',
E                       b'itty',
E                       b'ive',
E                       b'iz',
E                       b'j',
E                       b'k',
E                       b'kay',
E                       b'ke',
E                       b'ked',
E                       b'king',
E                       b'l',
E                       b'ld',
E                       b'le',
E                       b'les',
E                       b'lew',
E                       b'lf',
E                       b'll',
E                       b'ly',
E                       b'm',
E                       b'more',
E                       b'my',
E                       b'n',
E                       b'nd',
E                       b'nder',
E                       b'nn',
E                       b'nna',
E                       b'nt',
E                       b'ny',
E                       b'o',
E                       b'ob',
E                       b'og',
E                       b'om',
E                       b'ome',
E                       b'omet',
E                       b'on',
E                       b'one',
E                       b'ong',
E                       b'oo',
E                       b'ood',
E                       b'ook',
E                       b'ool',
E                       b'op',
E                       b'ople',
E                       b'or',
E                       b'ore',
E                       b'orn',
E                       b'ort',
E                       b'ot',
E                       b'other',
E                       b'ou',
E                       b'oud',
E                       b'oug',
E                       b'ough',
E                       b'ought',
E                       b'ould',
E                       b'ound',
E                       b'our',
E                       b'ous',
E                       b'ouse',
E                       b'out',
E                       b'ow',
E                       b'own',
E                       b'oy',
E                       b'p',
E                       b'pec',
E                       b'pected',
E                       b'pl',
E                       b'pot',
E                       b'pp',
E                       b'pped',
E                       b'pr',
E                       b'q',
E                       b'qu',
E                       b'r',
E                       b'ra',
E                       b're',
E                       b'ret',
E                       b'ri',
E                       b'ried',
E                       b'riend',
E                       b'rm',
E                       b'ro',
E                       b'rom',
E                       b'round',
E                       b'ry',
E                       b's',
E                       b'se',
E                       b'side',
E                       b'ss',
E                       b'st',
E                       b't',
E                       b'ted',
E                       b'ter',
E                       b'ture',
E                       b'ty',
E                       b'u',
E                       b'uc',
E                       b'uch',
E                       b'uck',
E                       b'ucy',
E                       b'udd',
E                       b'udden',
E                       b'uddenly',
E                       b'ue',
E                       b'uff',
E                       b'uffy',
E                       b'ug',
E                       b'ul',
E                       b'ull',
E                       b'um',
E                       b'ummy',
E                       b'ump',
E                       b'un',
E                       b'ur',
E                       b'ure',
E                       b'urn',
E                       b'urt',
E                       b'us',
E                       b'use',
E                       b'ust',
E                       b'ut',
E                       b'v',
E                       b've',
E                       b'ved',
E                       b'ven',
E                       b'ver',
E                       b'very',
E                       b'ving',
E                       b'w',
E                       b'way',
E                       b'ways',
E                       b'x',
E                       b'xt',
E                       b'y',
E                       b'z',
E                       b'{',
E                       b'|',
E                       b'}',
E                       b'~',
E                       b'\x7f',
E                       b'\x80',
E                       b'\x81',
E                       b'\x82',
E                       b'\x83',
E                       b'\x84',
E                       b'\x85',
E                       b'\x86',
E                       b'\x87',
E                       b'\x88',
E                       b'\x89',
E                       b'\x8a',
E                       b'\x8b',
E                       b'\x8c',
E                       b'\x8d',
E                       b'\x8e',
E                       b'\x8f',
E                       b'\x90',
E                       b'\x91',
E                       b'\x92',
E                       b'\x93',
E                       b'\x94',
E                       b'\x95',
E                       b'\x96',
E                       b'\x97',
E                       b'\x98',
E                       b'\x99',
E                       b'\x9a',
E                       b'\x9b',
E                       b'\x9c',
E                       b'\x9d',
E                       b'\x9e',
E                       b'\x9f',
E                       b'\xa0',
E                       b'\xa1',
E                       b'\xa2',
E                       b'\xa3',
E                       b'\xa4',
E                       b'\xa5',
E                       b'\xa6',
E                       b'\xa7',
E                       b'\xa8',
E                       b'\xa9',
E                       b'\xaa',
E                       b'\xab',
E                       b'\xac',
E                       b'\xad',
E                       b'\xae',
E                       b'\xaf',
E                       b'\xb0',
E                       b'\xb1',
E                       b'\xb2',
E                       b'\xb3',
E                       b'\xb4',
E                       b'\xb5',
E                       b'\xb6',
E                       b'\xb7',
E                       b'\xb8',
E                       b'\xb9',
E                       b'\xba',
E                       b'\xbb',
E                       b'\xbc',
E                       b'\xbd',
E                       b'\xbe',
E                       b'\xbf',
E                       b'\xc0',
E                       b'\xc1',
E                       b'\xc2',
E                       b'\xc3',
E                       b'\xc4',
E                       b'\xc5',
E                       b'\xc6',
E                       b'\xc7',
E                       b'\xc8',
E                       b'\xc9',
E                       b'\xca',
E                       b'\xcb',
E                       b'\xcc',
E                       b'\xcd',
E                       b'\xce',
E                       b'\xcf',
E                       b'\xd0',
E                       b'\xd1',
E                       b'\xd2',
E                       b'\xd3',
E                       b'\xd4',
E                       b'\xd5',
E                       b'\xd6',
E                       b'\xd7',
E                       b'\xd8',
E                       b'\xd9',
E                       b'\xda',
E                       b'\xdb',
E                       b'\xdc',
E                       b'\xdd',
E                       b'\xde',
E                       b'\xdf',
E                       b'\xe0',
E                       b'\xe1',
E                       b'\xe2',
E                       b'\xe2\x80',
E                       b'\xe3',
E                       b'\xe4',
E                       b'\xe5',
E                       b'\xe6',
E                       b'\xe7',
E                       b'\xe8',
E                       b'\xe9',
E                       b'\xea',
E                       b'\xeb',
E                       b'\xec',
E                       b'\xed',
E                       b'\xee',
E                       b'\xef',
E                       b'\xf0',
E                       b'\xf1',
E                       b'\xf2',
E                       b'\xf3',
E                       b'\xf4',
E                       b'\xf5',
E                       b'\xf6',
E                       b'\xf7',
E                       b'\xf8',
E                       b'\xf9',
E                       b'\xfa',
E                       b'\xfb',
E                       b'\xfc',
E                       b'\xfd',
E                       b'\xfe',
E                       b'\xff',
E                   }

tests/conftest.py:146: AssertionError
=========================== short test summary info ============================
FAILED tests/test_train_bpe.py::test_train_bpe_special_tokens - AssertionError: Data for key 'vocab_values' does not match snapshot for test_train_bpe_special_tokens
assert {b'\x00', b'\... b'\x05', ...} == {b'\x00', b'\... b'\x05', ...}
  
  Extra items in the left set:
  b' magic'
  Extra items in the right set:
  b'\n\n\n'
  
  Full diff:
    {
        b'\x00',
        b'\x01',
        b'\x02',
        b'\x03',
        b'\x04',
        b'\x05',
        b'\x06',
        b'\x07',
        b'\x08',
        b'\t',
        b'\n',
        b'\n\n',
  -     b'\n\n\n',
        b'\x0b',
        b'\x0c',
        b'\r',
        b'\x0e',
        b'\x0f',
        b'\x10',
        b'\x11',
        b'\x12',
        b'\x13',
        b'\x14',
        b'\x15',
        b'\x16',
        b'\x17',
        b'\x18',
        b'\x19',
        b'\x1a',
        b'\x1b',
        b'\x1c',
        b'\x1d',
        b'\x1e',
        b'\x1f',
        b' ',
        b' "',
        b' A',
        b' Amy',
        b' And',
        b' Anna',
        b' B',
        b' Ben',
        b' Bob',
        b' But',
        b' D',
        b' E',
        b' Every',
        b' F',
        b' From',
        b' H',
        b' He',
        b' Her',
        b' His',
        b' I',
        b' In',
        b' It',
        b' J',
        b' K',
        b' Kitty',
        b' L',
        b' Lily',
        b' Lucy',
        b' M',
        b' Max',
        b' Mia',
        b' Mom',
        b' N',
        b' One',
        b' P',
        b' S',
        b' Sally',
        b' Sam',
        b' Sara',
        b' She',
        b' So',
        b' Spot',
        b' Sue',
        b' T',
        b' Th',
        b' The',
        b' Then',
        b' They',
        b' Tim',
        b' Tom',
        b' W',
        b' We',
        b' When',
        b' You',
        b' a',
        b' ab',
        b' about',
        b' after',
        b' ag',
        b' again',
        b' al',
        b' all',
        b' always',
        b' am',
        b' an',
        b' and',
        b' animal',
        b' animals',
        b' any',
        b' anymore',
        b' app',
        b' are',
        b' around',
        b' as',
        b' asked',
        b' at',
        b' away',
        b' b',
        b' back',
        b' bad',
        b' ball',
        b' be',
        b' bear',
        b' beaut',
        b' bec',
        b' became',
        b' because',
        b' best',
        b' better',
        b' big',
        b' bird',
        b' bl',
        b' blue',
        b' bo',
        b' boat',
        b' book',
        b' bot',
        b' both',
        b' box',
        b' boy',
        b' br',
        b' bro',
        b' bu',
        b' bug',
        b' but',
        b' by',
        b' c',
        b' ca',
        b' cake',
        b' call',
        b' came',
        b' can',
        b' car',
        b' care',
        b' careful',
        b' cat',
        b' ch',
        b' che',
        b' cl',
        b' cle',
        b' clean',
        b' clim',
        b' clo',
        b' co',
        b' col',
        b' color',
        b' com',
        b' come',
        b' could',
        b' cu',
        b' d',
        b' dad',
        b' dan',
        b' day',
        b' dec',
        b' decided',
        b' did',
        b' didn',
        b' do',
        b' dog',
        b' doll',
        b' don',
        b' door',
        b' down',
        b' dre',
        b' e',
        b' each',
        b' eat',
        b' en',
        b' end',
        b' even',
        b' ever',
        b' every',
        b' ex',
        b' exc',
        b' excited',
        b' f',
        b' fa',
        b' fam',
        b' family',
        b' far',
        b' fast',
        b' fe',
        b' feel',
        b' felt',
        b' fi',
        b' find',
        b' fish',
        b' fl',
        b' flew',
        b' flow',
        b' fly',
        b' fo',
        b' food',
        b' for',
        b' fore',
        b' forest',
        b' found',
        b' fr',
        b' friend',
        b' friends',
        b' frog',
        b' from',
        b' fun',
        b' g',
        b' garden',
        b' gave',
        b' get',
        b' gir',
        b' girl',
        b' give',
        b' gl',
        b' go',
        b' good',
        b' got',
        b' gr',
        b' gra',
        b' gre',
        b' great',
        b' ground',
        b' h',
        b' ha',
        b' had',
        b' hand',
        b' happ',
        b' happened',
        b' happily',
        b' happy',
        b' hard',
        b' hat',
        b' have',
        b' he',
        b' heard',
        b' hel',
        b' help',
        b' helped',
        b' her',
        b' hig',
        b' high',
        b' him',
        b' his',
        b' ho',
        b' home',
        b' house',
        b' how',
        b' hug',
        b' hugged',
        b' hurt',
        b' ide',
        b' idea',
        b' if',
        b' im',
        b' in',
        b' inside',
        b' int',
        b' into',
        b' is',
        b' it',
        b' its',
        b' j',
        b' jump',
        b' jumped',
        b' just',
        b' k',
        b' ke',
        b' kid',
        b' kind',
        b' kn',
        b' knew',
        b' know',
        b' l',
        b' la',
        b' laug',
        b' laughed',
        b' le',
        b' learn',
        b' learned',
        b' let',
        b' li',
        b' like',
        b' liked',
        b' list',
        b' listen',
        b' little',
        b' lived',
        b' lo',
        b' long',
        b' loo',
        b' look',
        b' looked',
        b' lot',
        b' lots',
        b' loud',
        b' love',
        b' loved',
        b' m',
        b' ma',
        b' made',
        b' mag',
  +     b' magic',
        b' make',
        b' man',
        b' many',
        b' me',
        b' met',
        b' mo',
        b' mom',
        b' more',
        b' much',
        b' my',
        b' n',
        b' nam',
        b' named',
        b' ne',
        b' near',
        b' need',
        b' never',
        b' new',
        b' next',
        b' nice',
        b' no',
        b' not',
        b' now',
        b' o',
        b' of',
        b' off',
        b' old',
        b' on',
        b' one',
        b' op',
        b' opened',
        b' or',
        b' other',
        b' out',
        b' outside',
        b' over',
        b' p',
        b' par',
        b' park',
        b' pe',
        b' people',
        b' pic',
        b' picked',
        b' pl',
        b' place',
        b' play',
        b' played',
        b' playing',
        b' po',
        b' pr',
        b' pret',
        b' pretty',
        b' proud',
        b' put',
        b' qu',
        b' r',
        b' ran',
        b' re',
        b' red',
        b' ro',
        b' rock',
        b' room',
        b' run',
        b' s',
        b' sa',
        b' sad',
        b' safe',
        b' said',
        b' saw',
        b' say',
        b' says',
        b' sc',
        b' scared',
        b' se',
        b' see',
        b' sh',
        b' share',
        b' she',
        b' shiny',
        b' should',
        b' show',
        b' showed',
        b' sk',
        b' sky',
        b' sl',
        b' sm',
        b' small',
        b' smile',
        b' smiled',
        b' sn',
        b' so',
        b' some',
        b' somet',
        b' something',
        b' sor',
        b' sorry',
        b' sp',
        b' special',
        b' squ',
        b' st',
        b' star',
        b' started',
        b' stick',
        b' still',
        b' sto',
        b' stor',
        b' str',
        b' strong',
        b' sun',
        b' sur',
        b' surpr',
        b' surprised',
        b' sw',
        b' t',
        b' ta',
        b' take',
        b' tal',
        b' te',
        b' th',
        b' than',
        b' thanked',
        b' that',
        b' the',
        b' their',
        b' them',
        b' then',
        b' there',
        b' they',
        b' things',
        b' this',
        b' thought',
        b' time',
        b' to',
        b' together',
        b' told',
        b' too',
        b' took',
        b' tow',
        b' town',
        b' toy',
        b' toys',
        b' tr',
        b' tre',
        b' tree',
        b' tried',
        b' try',
        b' turn',
        b' tw',
        b' u',
        b' un',
        b' under',
        b' unexpected',
        b' unt',
        b' until',
        b' up',
        b' upon',
        b' us',
        b' v',
        b' very',
        b' w',
        b' wa',
        b' wal',
        b' walk',
        b' walked',
        b' want',
        b' wanted',
        b' was',
        b' wat',
        b' water',
        b' way',
        b' we',
        b' went',
        b' were',
        b' wh',
        b' what',
        b' when',
        b' who',
        b' will',
        b' wind',
        b' with',
        b' wor',
        b' would',
        b' y',
        b' you',
        b' your',
        b'!',
        b'!"',
        b'"',
        b'#',
        b'$',
        b'%',
        b'&',
        b"'",
        b"'m",
        b"'s",
        b"'t",
        b'(',
        b')',
        b'*',
        b'+',
        b',',
        b',"',
        b'-',
        b'.',
        b'."',
        b'/',
        b'0',
        b'1',
        b'2',
        b'3',
        b'4',
        b'5',
        b'6',
        b'7',
        b'8',
        b'9',
        b':',
        b';',
        b'<',
        b'<|endoftext|>',
        b'=',
        b'>',
        b'?',
        b'?"',
        b'@',
        b'A',
        b'As',
        b'B',
        b'But',
        b'C',
        b'Can',
        b'D',
        b'E',
        b'F',
        b'G',
        b'H',
        b'I',
        b'J',
        b'K',
        b'L',
        b'Let',
        b'Lily',
        b'M',
        b'Mom',
        b'N',
        b'No',
        b'O',
        b'On',
        b'Once',
        b'One',
        b'P',
        b'Q',
        b'R',
        b'S',
        b'T',
        b'Th',
        b'Thank',
        b'The',
        b'They',
        b'Tim',
        b'Tom',
        b'U',
        b'V',
        b'W',
        b'Wh',
        b'X',
        b'Y',
        b'Yes',
        b'You',
        b'Z',
        b'[',
        b'\\',
        b']',
        b'^',
        b'_',
        b'`',
        b'a',
        b'ab',
        b'able',
        b'ace',
        b'ach',
        b'ack',
        b'ad',
        b'ade',
        b'ady',
        b'ag',
        b'age',
        b'ain',
        b'ak',
        b'ake',
        b'al',
        b'all',
        b'ally',
        b'am',
        b'ame',
        b'an',
        b'and',
        b'ank',
        b'ant',
        b'ap',
        b'ar',
        b'ara',
        b'ard',
        b'arden',
        b'are',
        b'ared',
        b'ark',
        b'arn',
        b'ary',
        b'as',
        b'ase',
        b'at',
        b'ate',
        b'ause',
        b'aut',
        b'ave',
        b'ax',
        b'ay',
        b'b',
        b'bed',
        b'ber',
        b'by',
        b'c',
        b'ce',
        b'ch',
        b'ched',
        b'ck',
        b'ct',
        b'd',
        b'dd',
        b'dy',
        b'e',
        b'ec',
        b'eci',
        b'ecial',
        b'ed',
        b'el',
        b'ell',
        b'elt',
        b'em',
        b'en',
        b'end',
        b'ened',
        b'ent',
        b'ep',
        b'er',
        b'ers',
        b'es',
        b'ess',
        b'et',
        b'etter',
        b'ew',
        b'ex',
        b'expected',
        b'f',
        b'fe',
        b'ff',
        b'ft',
        b'fter',
        b'ful',
        b'g',
        b'ge',
        b'ged',
        b'get',
        b'gether',
        b'gry',
        b'h',
        b'he',
        b'hed',
        b'hen',
        b'her',
        b'here',
        b'hes',
        b'hing',
        b'ht',
        b'i',
        b'ia',
        b'ic',
        b'ice',
        b'ick',
        b'id',
        b'ide',
        b'ided',
        b'ie',
        b'ies',
        b'if',
        b'ig',
        b'ight',
        b'il',
        b'ild',
        b'ile',
        b'iled',
        b'ill',
        b'ily',
        b'im',
        b'imal',
        b'ime',
        b'in',
        b'ind',
        b'ine',
        b'ing',
        b'ings',
        b'ink',
        b'iny',
        b'ion',
        b'ip',
        b'ir',
        b'ird',
        b'is',
        b'ise',
        b'ised',
        b'ish',
        b'ist',
        b'it',
        b'ite',
        b'ited',
        b'ith',
        b'itt',
        b'ittle',
        b'itty',
        b'ive',
        b'iz',
        b'j',
        b'k',
        b'kay',
        b'ke',
        b'ked',
        b'king',
        b'l',
        b'ld',
        b'le',
        b'les',
        b'lew',
        b'lf',
        b'll',
        b'ly',
        b'm',
        b'more',
        b'my',
        b'n',
        b'nd',
        b'nder',
        b'nn',
        b'nna',
        b'nt',
        b'ny',
        b'o',
        b'ob',
        b'og',
        b'om',
        b'ome',
        b'omet',
        b'on',
        b'one',
        b'ong',
        b'oo',
        b'ood',
        b'ook',
        b'ool',
        b'op',
        b'ople',
        b'or',
        b'ore',
        b'orn',
        b'ort',
        b'ot',
        b'other',
        b'ou',
        b'oud',
        b'oug',
        b'ough',
        b'ought',
        b'ould',
        b'ound',
        b'our',
        b'ous',
        b'ouse',
        b'out',
        b'ow',
        b'own',
        b'oy',
        b'p',
        b'pec',
        b'pected',
        b'pl',
        b'pot',
        b'pp',
        b'pped',
        b'pr',
        b'q',
        b'qu',
        b'r',
        b'ra',
        b're',
        b'ret',
        b'ri',
        b'ried',
        b'riend',
        b'rm',
        b'ro',
        b'rom',
        b'round',
        b'ry',
        b's',
        b'se',
        b'side',
        b'ss',
        b'st',
        b't',
        b'ted',
        b'ter',
        b'ture',
        b'ty',
        b'u',
        b'uc',
        b'uch',
        b'uck',
        b'ucy',
        b'udd',
        b'udden',
        b'uddenly',
        b'ue',
        b'uff',
        b'uffy',
        b'ug',
        b'ul',
        b'ull',
        b'um',
        b'ummy',
        b'ump',
        b'un',
        b'ur',
        b'ure',
        b'urn',
        b'urt',
        b'us',
        b'use',
        b'ust',
        b'ut',
        b'v',
        b've',
        b'ved',
        b'ven',
        b'ver',
        b'very',
        b'ving',
        b'w',
        b'way',
        b'ways',
        b'x',
        b'xt',
        b'y',
        b'z',
        b'{',
        b'|',
        b'}',
        b'~',
        b'\x7f',
        b'\x80',
        b'\x81',
        b'\x82',
        b'\x83',
        b'\x84',
        b'\x85',
        b'\x86',
        b'\x87',
        b'\x88',
        b'\x89',
        b'\x8a',
        b'\x8b',
        b'\x8c',
        b'\x8d',
        b'\x8e',
        b'\x8f',
        b'\x90',
        b'\x91',
        b'\x92',
        b'\x93',
        b'\x94',
        b'\x95',
        b'\x96',
        b'\x97',
        b'\x98',
        b'\x99',
        b'\x9a',
        b'\x9b',
        b'\x9c',
        b'\x9d',
        b'\x9e',
        b'\x9f',
        b'\xa0',
        b'\xa1',
        b'\xa2',
        b'\xa3',
        b'\xa4',
        b'\xa5',
        b'\xa6',
        b'\xa7',
        b'\xa8',
        b'\xa9',
        b'\xaa',
        b'\xab',
        b'\xac',
        b'\xad',
        b'\xae',
        b'\xaf',
        b'\xb0',
        b'\xb1',
        b'\xb2',
        b'\xb3',
        b'\xb4',
        b'\xb5',
        b'\xb6',
        b'\xb7',
        b'\xb8',
        b'\xb9',
        b'\xba',
        b'\xbb',
        b'\xbc',
        b'\xbd',
        b'\xbe',
        b'\xbf',
        b'\xc0',
        b'\xc1',
        b'\xc2',
        b'\xc3',
        b'\xc4',
        b'\xc5',
        b'\xc6',
        b'\xc7',
        b'\xc8',
        b'\xc9',
        b'\xca',
        b'\xcb',
        b'\xcc',
        b'\xcd',
        b'\xce',
        b'\xcf',
        b'\xd0',
        b'\xd1',
        b'\xd2',
        b'\xd3',
        b'\xd4',
        b'\xd5',
        b'\xd6',
        b'\xd7',
        b'\xd8',
        b'\xd9',
        b'\xda',
        b'\xdb',
        b'\xdc',
        b'\xdd',
        b'\xde',
        b'\xdf',
        b'\xe0',
        b'\xe1',
        b'\xe2',
        b'\xe2\x80',
        b'\xe3',
        b'\xe4',
        b'\xe5',
        b'\xe6',
        b'\xe7',
        b'\xe8',
        b'\xe9',
        b'\xea',
        b'\xeb',
        b'\xec',
        b'\xed',
        b'\xee',
        b'\xef',
        b'\xf0',
        b'\xf1',
        b'\xf2',
        b'\xf3',
        b'\xf4',
        b'\xf5',
        b'\xf6',
        b'\xf7',
        b'\xf8',
        b'\xf9',
        b'\xfa',
        b'\xfb',
        b'\xfc',
        b'\xfd',
        b'\xfe',
        b'\xff',
    }
============================== 1 failed in 9.24s ===============================
